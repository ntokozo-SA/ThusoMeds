<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MamaCare - Pregnancy Care Assistant</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
  <div class="container">
    <header>
      <h1>ü§± MamaCare</h1>

      <div class="dashboard-link">
        <a href="dashboard.html" class="dashboard-btn">
          <i class="fas fa-tachometer-alt"></i> Pregnancy Care Dashboard
        </a>
      </div>
    </header>
    <section class="facility-choice">
      <div class="subtitle">Choose your pregnancy care facility:</div>
      <div class="facility-buttons">
        <button class="facility-btn" onclick="showNearbyFacilities('Maternity Clinic')">
          <i class="fas fa-stethoscope"></i> Maternity Clinic<br>
          <small>Routine prenatal care, checkups, and consultations</small>
        </button>
        <button class="facility-btn" onclick="showNearbyFacilities('Hospital')">
          <i class="fas fa-hospital"></i> Hospital with Labor Ward<br>
          <small>Emergency care, labor & delivery, and specialized maternity services</small>
        </button>
      </div>
    </section>
    
    <!-- Location detection section -->
    <section id="locationSection" class="location-section" style="display: none;">
      <div class="location-header">
        <h3>üìç Finding facilities near you...</h3>
        <button id="getLocationBtn" class="location-btn">üìç Get My Location</button>
      </div>
      <div id="locationStatus" class="location-status"></div>
    </section>
    
    <!-- Nearby facilities list -->
    <section id="facilitiesList" class="facilities-list" style="display: none;">
      <h3 id="facilitiesTitle">Nearby Facilities</h3>
      <div id="facilitiesContainer"></div>
    </section>
  </div>

  <script>
    let selectedFacilityType = '';
    let userLocation = null;

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      const getLocationBtn = document.getElementById('getLocationBtn');
      if (getLocationBtn) {
        getLocationBtn.addEventListener('click', getCurrentLocation);
      }
    });

    function showNearbyFacilities(type) {
      selectedFacilityType = type;
      
      // Show location section
      document.getElementById('locationSection').style.display = 'block';
      document.getElementById('facilitiesList').style.display = 'none';
      
      // Update title
      document.getElementById('facilitiesTitle').textContent = `Nearby ${type}s`;
      
      // Show location button
      document.getElementById('locationStatus').textContent = 'Click the button below to find facilities near you';
    }

    function getCurrentLocation() {
      const statusElement = document.getElementById('locationStatus');
      
      if (!navigator.geolocation) {
        statusElement.textContent = '‚ùå Geolocation not supported by this browser.';
        return;
      }

      statusElement.textContent = 'üìç Getting your location...';
      
      navigator.geolocation.getCurrentPosition(
        function(position) {
          userLocation = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };
          
          statusElement.textContent = `‚úÖ Location found! (${userLocation.lat.toFixed(4)}, ${userLocation.lng.toFixed(4)})`;
          
          // Show nearby facilities
          setTimeout(() => {
            showFacilitiesList();
          }, 1000);
        },
        function(error) {
          let errorMessage = '‚ùå Error getting location: ';
          switch(error.code) {
            case error.PERMISSION_DENIED:
              errorMessage += 'Permission denied. Please allow location access.';
              break;
            case error.POSITION_UNAVAILABLE:
              errorMessage += 'Position unavailable.';
              break;
            case error.TIMEOUT:
              errorMessage += 'Request timeout.';
              break;
            default:
              errorMessage += 'Unknown error.';
              break;
          }
          statusElement.textContent = errorMessage;
        }
      );
    }

    function showFacilitiesList() {
      // Hide location section and show facilities list
      document.getElementById('locationSection').style.display = 'none';
      document.getElementById('facilitiesList').style.display = 'block';
      
      // Generate sample nearby facilities (in a real app, this would come from an API)
      const facilities = generateNearbyFacilities();
      
      const container = document.getElementById('facilitiesContainer');
      container.innerHTML = '';
      
      facilities.forEach((facility, index) => {
        const facilityCard = document.createElement('div');
        facilityCard.className = 'facility-card';
        facilityCard.innerHTML = `
          <div class="facility-info">
            <h4>${facility.name}</h4>
            <p class="facility-address">üìç ${facility.address}</p>
            <p class="facility-distance">üöó ${facility.distance} km away</p>
            <p class="facility-hours">üïí ${facility.hours}</p>
            <p class="facility-phone">üìû ${facility.phone}</p>
            <p class="facility-services">üè• ${facility.services}</p>
          </div>
          <button class="select-facility-btn" onclick="selectFacility(${index})">
            <i class="fas fa-check"></i> Select This ${selectedFacilityType}
          </button>
        `;
        container.appendChild(facilityCard);
      });
    }

    function generateNearbyFacilities() {
      // Sample pregnancy care facilities data (in a real app, this would come from a database/API)
      const clinicData = [
        {
          name: "MamaCare Maternity Clinic",
          address: "123 Main Street, Johannesburg",
          distance: "2.3",
          hours: "Mon-Fri: 8AM-6PM, Sat: 8AM-2PM",
          phone: "+27 11 123 4567",
          services: "Prenatal care, ultrasounds, routine checkups"
        },
        {
          name: "Rose Maternity Center",
          address: "456 Oak Avenue, Sandton",
          distance: "3.7",
          hours: "Mon-Fri: 7AM-7PM, Sat-Sun: 9AM-4PM",
          phone: "+27 11 234 5678",
          services: "Prenatal care, birthing classes, postnatal support"
        },
        {
          name: "Family Birth Center",
          address: "789 Pine Road, Rosebank",
          distance: "5.1",
          hours: "Mon-Fri: 8AM-5PM",
          phone: "+27 11 345 6789",
          services: "Complete maternity care, lactation support"
        }
      ];

      const hospitalData = [
        {
          name: "Johannesburg Maternity Hospital",
          address: "100 Hospital Drive, Johannesburg",
          distance: "4.2",
          hours: "24/7 Emergency Services & Labor Ward",
          phone: "+27 11 456 7890",
          services: "Labor & delivery, emergency care, NICU"
        },
        {
          name: "Sandton Women's Hospital",
          address: "200 Health Boulevard, Sandton",
          distance: "6.8",
          hours: "24/7 Emergency Services & Labor Ward",
          phone: "+27 11 567 8901",
          services: "High-risk pregnancies, emergency delivery, specialized care"
        },
        {
          name: "Rosebank Maternity Wing",
          address: "300 Wellness Way, Rosebank",
          distance: "7.5",
          hours: "24/7 Emergency Services & Labor Ward",
          phone: "+27 11 678 9012",
          services: "Complete maternity services, emergency obstetric care"
        }
      ];

      return selectedFacilityType === 'Maternity Clinic' ? clinicData : hospitalData;
    }

    function selectFacility(facilityIndex) {
      const facilities = generateNearbyFacilities();
      const selectedFacility = facilities[facilityIndex];
      
      // Store selected facility in localStorage for use in the form
      localStorage.setItem('selectedFacility', JSON.stringify({
        type: selectedFacilityType,
        facility: selectedFacility
      }));
      
      // Redirect to the appropriate form
      if (selectedFacilityType === 'Maternity Clinic') {
        window.location.href = 'clinic.html';
      } else {
        window.location.href = 'hospital.html';
      }
    }
  </script>
</body>
</html>
